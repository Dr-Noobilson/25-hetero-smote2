# HetGSMOTE: A SMOTE-Based Oversampling Framework for Heterogeneous Graphs

Graph Neural Networks (GNNs) have proven effective for learning from graph-structured data, with heterogeneous graphs (HetGs) gaining particular prominence for their ability to model diverse real-world systems through multiple node and edge types. However, **class imbalance**—where certain node classes are significantly underrepresented—presents a critical challenge for node classification on HetGs.

This work introduces **HetGSMOTE**, a novel oversampling framework that extends SMOTE-based techniques to heterogeneous graphs by incorporating **node type, edge type**, and **metapath** information into synthetic sample generation. It constructs a **content- and neighbor-type-aggregated embedding space**, generates synthetic minority nodes, and trains **specialized edge generators** for each node type to preserve relational structure.

HetGSMOTE outperforms state-of-the-art baselines across multiple benchmark datasets and heterogeneous GNN architectures—especially under **extreme class imbalance scenarios**.

---

## 📦 Setup

Create a virtual environment and install dependencies:

```bash
python -m venv venv
source venv/bin/activate
pip install -r 25-hetero-smote/requirements.txt
```

---

## 📊 Datasets Overview

The datasets used include varying types of nodes, edges, and levels of imbalance. The labeled node type is marked with `*`.

| Dataset      | Node Types           | #Nodes | Edge Types                | #Edges | Classes (Minority) |
|--------------|----------------------|--------|----------------------------|--------|---------------------|
| **AMiner-AII** | author*, paper, venue | 20,171 | author-paper, paper-paper, paper-venue | 70,212 | 4 (3) |
| **IMDb**     | movie*, actor, director | 4,666  | movie-actor, movie-director | 18,656 | 3 (2) |
| **DBLP**     | paper*, author, term, conference | 14,328 | author-paper, paper-term, paper-conference | 119,783 | 4 (3) |
| **PubMed**   | nodes                 | 63,109 | edges                      | 244,986| 8 (6) |

---


## 📂 Folder Structure

```bash
25-hetero-smote/
├── aminer_train/
│   └── data/
│   └── train/
│       ├── han/
│       ├── hgnn/
│       └── magnn/
├── imdb_train/
├── dblp_train/
├── pubmed_train/
├── requirements.txt
├── metric.py
├── smote.py
├── args.py
└── README.md
```

---

## 🚀 Results Reproducibility

### ➤ Imbalance Ratio and Training Size Experiments
```bash
python imdb_train/train/han/trainer.py
```

### ➤ Upsampling Ratio Experiments
```bash
python imdb_train/train/han/trainer_up.py
```

- Replace `han` in the path with `hgnn` or `magnn` to switch models.
- Replace `imdb_train` with `aminer_train`, `dblp_train`, or `pubmed_train` to run on other datasets.
- For `aminer_train` and `pubmed_train`, `trainer.py` file runs both the tests.
- These files include both training and evaluation code for all the list of parameters, iterations and metrics.

---

## Experimental Results

This section presents the experimental results for evaluating graph neural network models (HAN, MAGNN, HGNN) under various baselines, HetGSMOTE settings and datasets. The tables below report mean accuracy (ACC) and standard deviation, with additional metrics (F1-Score, AUC) for HetGSMOTE. Datasets include IMDb, AMINER, Pubmed, and DBLP, with imbalance ratios (IM-RATIO) from 0.1 to 0.9. Experiments also explore training size and upsampling ratio impacts.

### Influence of Base-Model
Compares HAN, MAGNN, and HGNN on IMDb dataset across settings (no, up, smote, reweight, embed_sm, em_smote, GSM_base, GSM_S, GSM_PT, HetGSM) and IM-RATIO. **HetGSM** (bold) and **GSM_PT** (underline) perform best.

| Model | Settings | 0.1 | 0.2 | 0.3 | 0.4 | 0.5 | 0.6 | 0.7 | 0.8 | 0.9 |
|-------|----------|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| HAN | no | 0.447 ± 0.018 | 0.458 ± 0.021 | 0.479 ± 0.023 | 0.5 ± 0.025 | 0.517 ± 0.037 | 0.515 ± 0.026 | 0.525 ± 0.036 | 0.516 ± 0.029 | 0.518 ± 0.029 |
| | up | 0.443 ± 0.023 | 0.456 ± 0.026 | 0.472 ± 0.024 | 0.485 ± 0.028 | 0.511 ± 0.024 | 0.508 ± 0.029 | 0.52 ± 0.031 | 0.52 ± 0.02 | 0.523 ± 0.024 |
| | smote | 0.451 ± 0.022 | 0.456 ± 0.03 | 0.477 ± 0.029 | 0.495 ± 0.023 | 0.509 ± 0.032 | 0.525 ± 0.025 | 0.521 ± 0.028 | 0.517 ± 0.03 | 0.521 ± 0.032 |
| | reweight | 0.452 ± 0.015 | 0.476 ± 0.024 | 0.499 ± 0.032 | **0.518 ± 0.02** | 0.515 ± 0.019 | 0.523 ± 0.017 | 0.528 ± 0.019 | **0.531 ± 0.021** | **0.534 ± 0.029** |
| | embed_sm | 0.445 ± 0.017 | 0.45 ± 0.029 | 0.46 ± 0.024 | 0.481 ± 0.029 | 0.49 ± 0.028 | 0.499 ± 0.027 | 0.507 ± 0.026 | 0.509 ± 0.026 | 0.519 ± 0.024 |
| | em_smote | 0.455 ± 0.016 | 0.487 ± 0.028 | 0.494 ± 0.036 | 0.503 ± 0.024 | 0.517 ± 0.025 | 0.524 ± 0.028 | **0.529 ± 0.026** | 0.527 ± 0.025 | 0.529 ± 0.021 |
| | GSM_base | 0.449 ± 0.018 | 0.481 ± 0.022 | 0.495 ± 0.032 | 0.501 ± 0.028 | 0.52 ± 0.032 | 0.525 ± 0.033 | **0.533 ± 0.035** | 0.525 ± 0.038 | **0.537 ± 0.023** |
| | GSM_S | 0.458 ± 0.026 | 0.483 ± 0.031 | 0.488 ± 0.029 | 0.505 ± 0.032 | **0.524 ± 0.029** | 0.517 ± 0.03 | 0.526 ± 0.035 | 0.526 ± 0.029 | **0.535 ± 0.019** |
| | GSM_PT | **0.471 ± 0.013** | **0.484 ± 0.026** | **0.505 ± 0.027** | _0.516 ± 0.015_ | _0.52 ± 0.025_ | _0.534 ± 0.019_ | 0.528 ± 0.03 | _0.54 ± 0.023_ | _0.544 ± 0.028_ |
| | **HetGSM** | **0.472 ± 0.014** | **0.489 ± 0.017** | **0.495 ± 0.024** | **0.518 ± 0.015** | **0.528 ± 0.035** | **0.537 ± 0.017** | **0.531 ± 0.023** | **0.544 ± 0.026** | **0.534 ± 0.031** |
| MAGNN | no | 0.34 ± 0.014 | 0.342 ± 0.016 | 0.343 ± 0.019 | 0.34 ± 0.008 | 0.341 ± 0.012 | 0.345 ± 0.016 | 0.336 ± 0.003 | 0.346 ± 0.017 | 0.344 ± 0.012 |
| | up | 0.378 ± 0.038 | 0.393 ± 0.051 | 0.423 ± 0.046 | 0.453 ± 0.044 | 0.448 ± 0.037 | 0.462 ± 0.037 | 0.478 ± 0.046 | 0.478 ± 0.045 | 0.449 ± 0.024 |
| | smote | 0.355 ± 0.027 | 0.371 ± 0.042 | 0.398 ± 0.023 | 0.412 ± 0.045 | 0.419 ± 0.053 | 0.432 ± 0.043 | 0.432 ± 0.053 | 0.469 ± 0.039 | 0.461 ± 0.037 |
| | reweight | 0.357 ± 0.022 | 0.348 ± 0.022 | 0.367 ± 0.039 | 0.406 ± 0.067 | 0.338 ± 0.011 | 0.352 ± 0.038 | 0.348 ± 0.024 | 0.338 ± 0.008 | 0.34 ± 0.008 |
| | embed_sm | 0.346 ± 0.011 | 0.346 ± 0.023 | 0.348 ± 0.025 | 0.35 ± 0.025 | 0.346 ± 0.015 | 0.339 ± 0.008 | 0.345 ± 0.012 | 0.342 ± 0.013 | 0.363 ± 0.023 |
| | em_smote | 0.43 ± 0.044 | 0.47 ± 0.019 | 0.488 ± 0.024 | **0.501 ± 0.021** | 0.474 ± 0.045 | 0.497 ± 0.031 | **0.513 ± 0.018** | 0.489 ± 0.034 | **0.504 ± 0.031** |
| | GSM_base | 0.366 ± 0.031 | 0.355 ± 0.021 | 0.352 ± 0.023 | 0.353 ± 0.019 | 0.362 ± 0.021 | 0.356 ± 0.02 | 0.383 ± 0.038 | 0.363 ± 0.033 | 0.363 ± 0.026 |
| | GSM_S | 0.375 ± 0.038 | 0.388 ± 0.04 | 0.359 ± 0.042 | 0.364 ± 0.038 | 0.389 ± 0.032 | 0.384 ± 0.044 | 0.367 ± 0.033 | 0.361 ± 0.025 | 0.39 ± 0.034 |
| | GSM_PT | **0.446 ± 0.021** | **0.481 ± 0.026** | **0.478 ± 0.015** | _0.497 ± 0.023_ | **0.506 ± 0.023** | _0.518 ± 0.028_ | _0.515 ± 0.022_ | _0.518 ± 0.028_ | _0.516 ± 0.028_ |
| | **HetGSM** | **0.454 ± 0.026** | **0.475 ± 0.016** | **0.489 ± 0.023** | **0.498 ± 0.026** | **0.51 ± 0.026** | **0.525 ± 0.022** | **0.512 ± 0.027** | **0.52 ± 0.027** | **0.509 ± 0.024** |
| HGNN | no | 0.43 ± 0.017 | 0.453 ± 0.026 | 0.463 ± 0.026 | 0.487 ± 0.027 | 0.49 ± 0.026 | 0.501 ± 0.023 | 0.497 ± 0.028 | 0.5 ± 0.021 | 0.502 ± 0.03 |
| | up | 0.434 ± 0.02 | 0.446 ± 0.024 | 0.467 ± 0.024 | 0.49 ± 0.027 | 0.49 ± 0.025 | 0.503 ± 0.025 | 0.505 ± 0.03 | 0.502 ± 0.021 | 0.494 ± 0.019 |
| | smote | 0.432 ± 0.009 | 0.455 ± 0.024 | 0.467 ± 0.028 | 0.483 ± 0.025 | 0.496 ± 0.026 | 0.499 ± 0.017 | 0.51 ± 0.032 | 0.497 ± 0.028 | 0.511 ± 0.033 |
| | reweight | 0.434 ± 0.016 | 0.44 ± 0.033 | 0.456 ± 0.028 | 0.466 ± 0.028 | 0.489 ± 0.028 | 0.488 ± 0.029 | 0.508 ± 0.041 | 0.499 ± 0.021 | **0.512 ± 0.03** |
| | embed_sm | 0.435 ± 0.019 | 0.457 ± 0.024 | 0.466 ± 0.016 | 0.475 ± 0.035 | **0.5 ± 0.028** | 0.494 ± 0.035 | 0.503 ± 0.025 | 0.501 ± 0.019 | 0.495 ± 0.022 |
| | em_smote | 0.434 ± 0.022 | 0.442 ± 0.023 | 0.456 ± 0.027 | 0.479 ± 0.026 | 0.494 ± 0.031 | 0.501 ± 0.025 | 0.497 ± 0.031 | 0.498 ± 0.028 | 0.501 ± 0.031 |
| | GSM_base | 0.434 ± 0.014 | 0.438 ± 0.022 | 0.461 ± 0.017 | 0.475 ± 0.026 | 0.483 ± 0.026 | 0.492 ± 0.026 | 0.492 ± 0.017 | **0.506 ± 0.025** | **0.513 ± 0.03** |
| | GSM_S | 0.431 ± 0.021 | 0.433 ± 0.018 | 0.461 ± 0.028 | 0.471 ± 0.033 | 0.488 ± 0.03 | 0.492 ± 0.026 | **0.499 ± 0.03** | **0.504 ± 0.024** | 0.506 ± 0.025 |
| | GSM_PT | **0.441 ± 0.013** | **0.457 ± 0.012** | **0.461 ± 0.015** | **0.486 ± 0.024** | 0.491 ± 0.032 | **0.503 ± 0.024** | _0.507 ± 0.018_ | _0.5 ± 0.021_ | _0.51 ± 0.032_ |
| | **HetGSM** | **0.444 ± 0.018** | **0.448 ± 0.021** | **0.476 ± 0.023** | **0.495 ± 0.025** | **0.503 ± 0.033** | **0.508 ± 0.024** | **0.498 ± 0.024** | **0.507 ± 0.022** | **0.508 ± 0.021** |


### HetGSMOTE Performance
Evaluates HetGSMOTE on the IMDb dataset across ACC, F1-Score, and AUC metrics for various IM-RATIO values. 

| Model | Settings | 0.1 | 0.2 | 0.3 | 0.4 | 0.5 | 0.6 | 0.7 | 0.8 | 0.9 |
|-------|----------|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| ACC | no | 0.447 ± 0.018 | 0.458 ± 0.021 | 0.479 ± 0.023 | 0.5 ± 0.025 | 0.517 ± 0.037 | 0.515 ± 0.026 | 0.525 ± 0.036 | 0.516 ± 0.029 | 0.518 ± 0.029 |
| | up | 0.443 ± 0.023 | 0.456 ± 0.026 | 0.472 ± 0.024 | 0.485 ± 0.028 | 0.511 ± 0.024 | 0.508 ± 0.029 | 0.52 ± 0.031 | 0.52 ± 0.02 | 0.523 ± 0.024 |
| | smote | 0.451 ± 0.022 | 0.456 ± 0.03 | 0.477 ± 0.029 | 0.495 ± 0.023 | 0.509 ± 0.032 | 0.525 ± 0.025 | 0.521 ± 0.028 | 0.517 ± 0.03 | 0.521 ± 0.032 |
| | reweight | 0.452 ± 0.015 | 0.476 ± 0.024 | 0.499 ± 0.032 | **0.518 ± 0.02** | 0.515 ± 0.019 | 0.523 ± 0.017 | 0.528 ± 0.019 | **0.531 ± 0.021** | **0.534 ± 0.029** |
| | embed_sm | 0.445 ± 0.017 | 0.45 ± 0.029 | 0.46 ± 0.024 | 0.481 ± 0.029 | 0.49 ± 0.028 | 0.499 ± 0.027 | 0.507 ± 0.026 | 0.509 ± 0.026 | 0.519 ± 0.024 |
| | em_smote | 0.455 ± 0.016 | 0.487 ± 0.028 | 0.494 ± 0.036 | 0.503 ± 0.024 | 0.517 ± 0.025 | 0.524 ± 0.028 | **0.529 ± 0.026** | 0.527 ± 0.025 | 0.529 ± 0.021 |
| | GSM_base | 0.449 ± 0.018 | 0.481 ± 0.022 | 0.495 ± 0.032 | 0.501 ± 0.028 | 0.52 ± 0.032 | 0.525 ± 0.033 | **0.533 ± 0.035** | 0.525 ± 0.038 | **0.537 ± 0.023** |
| | GSM_S | 0.458 ± 0.026 | 0.483 ± 0.031 | 0.488 ± 0.029 | 0.505 ± 0.032 | **0.524 ± 0.029** | 0.517 ± 0.03 | 0.526 ± 0.035 | 0.526 ± 0.029 | **0.535 ± 0.019** |
| | GSM_PT | **0.471 ± 0.013** | **0.484 ± 0.026** | **0.505 ± 0.027** | _0.516 ± 0.015_ | _0.52 ± 0.025_ | _0.534 ± 0.019_ | 0.528 ± 0.03 | _0.54 ± 0.023_ | _0.544 ± 0.028_ |
| | **HetGSM** | **0.472 ± 0.014** | **0.489 ± 0.017** | **0.495 ± 0.024** | **0.518 ± 0.015** | **0.528 ± 0.035** | **0.537 ± 0.017** | **0.531 ± 0.023** | **0.544 ± 0.026** | **0.534 ± 0.031** |
| F1-Score | no | 0.55 ± 0.018 | 0.554 ± 0.012 | 0.557 ± 0.016 | 0.564 ± 0.013 | 0.573 ± 0.016 | 0.563 ± 0.009 | 0.57 ± 0.015 | 0.566 ± 0.017 | 0.568 ± 0.018 |
| | up | 0.545 ± 0.013 | 0.546 ± 0.017 | 0.551 ± 0.01 | 0.553 ± 0.015 | 0.559 ± 0.015 | 0.562 ± 0.017 | 0.567 ± 0.02 | 0.561 ± 0.014 | 0.566 ± 0.019 |
| | smote | 0.545 ± 0.014 | 0.55 ± 0.016 | 0.549 ± 0.018 | 0.558 ± 0.011 | 0.561 ± 0.02 | 0.568 ± 0.013 | 0.567 ± 0.017 | 0.566 ± 0.017 | 0.565 ± 0.014 |
| | reweight | 0.541 ± 0.011 | 0.551 ± 0.016 | 0.556 ± 0.016 | 0.56 ± 0.012 | 0.569 ± 0.01 | 0.567 ± 0.018 | 0.569 ± 0.014 | **0.574 ± 0.01** | **0.581 ± 0.017** |
| | embed_sm | 0.544 ± 0.01 | 0.543 ± 0.019 | 0.545 ± 0.012 | 0.549 ± 0.011 | 0.555 ± 0.014 | 0.555 ± 0.007 | 0.56 ± 0.017 | 0.558 ± 0.014 | 0.571 ± 0.012 |
| | em_smote | 0.547 ± 0.021 | 0.553 ± 0.015 | 0.556 ± 0.016 | 0.558 ± 0.012 | 0.568 ± 0.014 | 0.568 ± 0.012 | **0.572 ± 0.019** | 0.566 ± 0.018 | 0.568 ± 0.013 |
| | GSM_base | 0.545 ± 0.014 | 0.552 ± 0.017 | 0.562 ± 0.011 | 0.556 ± 0.022 | 0.569 ± 0.021 | **0.572 ± 0.018** | **0.573 ± 0.018** | 0.571 ± 0.017 | 0.57 ± 0.016 |
| | GSM_S | 0.547 ± 0.021 | 0.553 ± 0.016 | 0.557 ± 0.017 | 0.557 ± 0.018 | 0.567 ± 0.018 | 0.562 ± 0.018 | 0.568 ± 0.015 | 0.568 ± 0.015 | **0.576 ± 0.014** |
| | GSM_PT | **0.551 ± 0.009** | **0.559 ± 0.02** | **0.565 ± 0.02** | **0.565 ± 0.012** | **0.57 ± 0.017** | **0.573 ± 0.018** | 0.568 ± 0.018 | _0.578 ± 0.018_ | _0.579 ± 0.018_ |
| | **HetGSM** | **0.553 ± 0.01** | **0.561 ± 0.017** | **0.562 ± 0.016** | **0.571 ± 0.021** | **0.57 ± 0.024** | **0.573 ± 0.015** | **0.575 ± 0.017** | **0.576 ± 0.019** | **0.579 ± 0.018** |
| AUC | no | 0.661 ± 0.03 | 0.67 ± 0.022 | 0.682 ± 0.028 | 0.699 ± 0.018 | 0.706 ± 0.021 | 0.699 ± 0.014 | 0.707 ± 0.017 | 0.703 ± 0.022 | 0.707 ± 0.02 |
| | up | 0.652 ± 0.023 | 0.662 ± 0.029 | 0.669 ± 0.02 | 0.675 ± 0.023 | 0.685 ± 0.018 | 0.692 ± 0.021 | 0.702 ± 0.028 | 0.694 ± 0.02 | 0.701 ± 0.024 |
| | smote | 0.658 ± 0.03 | 0.669 ± 0.027 | 0.67 ± 0.028 | 0.685 ± 0.011 | 0.692 ± 0.028 | 0.703 ± 0.02 | 0.699 ± 0.022 | 0.704 ± 0.023 | 0.703 ± 0.023 |
| | reweight | 0.645 ± 0.025 | 0.679 ± 0.029 | 0.686 ± 0.021 | 0.693 ± 0.016 | 0.703 ± 0.019 | 0.7 ± 0.02 | 0.703 ± 0.021 | **0.707 ± 0.018** | **0.716 ± 0.024** |
| | embed_sm | 0.646 ± 0.018 | 0.651 ± 0.031 | 0.66 ± 0.025 | 0.67 ± 0.018 | 0.676 ± 0.024 | 0.683 ± 0.017 | 0.689 ± 0.023 | 0.691 ± 0.02 | 0.705 ± 0.019 |
| | em_smote | 0.665 ± 0.031 | 0.68 ± 0.028 | 0.69 ± 0.021 | 0.69 ± 0.018 | 0.701 ± 0.018 | 0.704 ± 0.02 | **0.712 ± 0.021** | 0.702 ± 0.023 | 0.706 ± 0.014 |
| | GSM_base | 0.658 ± 0.023 | 0.679 ± 0.031 | 0.684 ± 0.023 | 0.688 ± 0.028 | 0.703 ± 0.027 | 0.706 ± 0.021 | 0.704 ± 0.029 | 0.708 ± 0.025 | 0.708 ± 0.021 |
| | GSM_S | 0.662 ± 0.034 | 0.675 ± 0.033 | 0.683 ± 0.028 | 0.688 ± 0.022 | 0.704 ± 0.026 | 0.699 ± 0.026 | 0.704 ± 0.024 | 0.706 ± 0.021 | **0.716 ± 0.015** |
| | GSM_PT | **0.664 ± 0.022** | **0.68 ± 0.025** | **0.697 ± 0.026** | **0.699 ± 0.016** | **0.705 ± 0.032** | **0.707 ± 0.018** | _0.709 ± 0.023_ | _0.713 ± 0.025_ | _0.713 ± 0.027_ |
| | **HetGSM** | **0.667 ± 0.02** | **0.685 ± 0.024** | **0.692 ± 0.019** | **0.705 ± 0.022** | **0.702 ± 0.023** | **0.713 ± 0.016** | **0.705 ± 0.02** | **0.713 ± 0.023** | **0.717 ± 0.024** |


### Dataset Comparison


| Dataset | Settings | 0.1 | 0.2 | 0.3 | 0.4 | 0.5 | 0.6 | 0.7 | 0.8 | 0.9 |
|---------|----------|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| IMDB | no | 0.447 ± 0.018 | 0.458 ± 0.021 | 0.479 ± 0.023 | 0.5 ± 0.025 | 0.517 ± 0.037 | 0.515 ± 0.026 | 0.525 ± 0.036 | 0.516 ± 0.029 | 0.518 ± 0.029 |
| | up | 0.443 ± 0.023 | 0.456 ± 0.026 | 0.472 ± 0.024 | 0.485 ± 0.028 | 0.511 ± 0.024 | 0.508 ± 0.029 | 0.52 ± 0.031 | 0.52 ± 0.02 | 0.523 ± 0.024 |
| | smote | 0.451 ± 0.022 | 0.456 ± 0.03 | 0.477 ± 0.029 | 0.495 ± 0.023 | 0.509 ± 0.032 | 0.525 ± 0.025 | 0.521 ± 0.028 | 0.517 ± 0.03 | 0.521 ± 0.032 |
| | reweight | 0.452 ± 0.015 | 0.476 ± 0.024 | 0.499 ± 0.032 | **0.518 ± 0.02** | 0.515 ± 0.019 | 0.523 ± 0.017 | 0.528 ± 0.019 | **0.531 ± 0.021** | **0.534 ± 0.029** |
| | embed_sm | 0.445 ± 0.017 | 0.45 ± 0.029 | 0.46 ± 0.024 | 0.481 ± 0.029 | 0.49 ± 0.028 | 0.499 ± 0.027 | 0.507 ± 0.026 | 0.509 ± 0.026 | 0.519 ± 0.024 |
| | em_smote | 0.455 ± 0.016 | 0.487 ± 0.028 | 0.494 ± 0.036 | 0.503 ± 0.024 | 0.517 ± 0.025 | 0.524 ± 0.028 | **0.529 ± 0.026** | 0.527 ± 0.025 | 0.529 ± 0.021 |
| | GSM_base | 0.449 ± 0.018 | 0.481 ± 0.022 | 0.495 ± 0.032 | 0.501 ± 0.028 | 0.52 ± 0.032 | 0.525 ± 0.033 | **0.533 ± 0.035** | 0.525 ± 0.038 | **0.537 ± 0.023** |
| | GSM_S | 0.458 ± 0.026 | 0.483 ± 0.031 | 0.488 ± 0.029 | 0.505 ± 0.032 | **0.524 ± 0.029** | 0.517 ± 0.03 | 0.526 ± 0.035 | 0.526 ± 0.029 | **0.535 ± 0.019** |
| | GSM_PT | **0.471 ± 0.013** | **0.484 ± 0.026** | **0.505 ± 0.027** | _0.516 ± 0.015_ | _0.52 ± 0.025_ | _0.534 ± 0.019_ | 0.528 ± 0.03 | _0.54 ± 0.023_ | _0.544 ± 0.028_ |
| | **HetGSM** | **0.472 ± 0.014** | **0.489 ± 0.017** | **0.495 ± 0.024** | **0.518 ± 0.015** | **0.528 ± 0.035** | **0.537 ± 0.017** | **0.531 ± 0.023** | **0.544 ± 0.026** | **0.534 ± 0.031** |
| AMINER | no | 0.925 ± 0.018 | 0.948 ± 0.014 | 0.961 ± 0.011 | 0.96 ± 0.012 | 0.96 ± 0.011 | 0.96 ± 0.011 | 0.965 ± 0.012 | 0.962 ± 0.013 | 0.957 ± 0.011 |
| | up | 0.938 ± 0.013 | 0.957 ± 0.009 | 0.958 ± 0.013 | 0.962 ± 0.011 | 0.965 ± 0.012 | 0.963 ± 0.014 | 0.959 ± 0.012 | **0.966 ± 0.011** | **0.967 ± 0.01** |
| | smote | 0.934 ± 0.02 | 0.954 ± 0.012 | 0.959 ± 0.015 | 0.963 ± 0.009 | 0.961 ± 0.014 | 0.963 ± 0.011 | 0.962 ± 0.016 | 0.962 ± 0.011 | **0.966 ± 0.009** |
| | reweight | 0.922 ± 0.02 | 0.949 ± 0.011 | 0.957 ± 0.011 | 0.959 ± 0.01 | 0.964 ± 0.007 | 0.962 ± 0.01 | 0.965 ± 0.008 | 0.963 ± 0.012 | 0.961 ± 0.009 |
| | embed_sm | 0.932 ± 0.022 | 0.952 ± 0.013 | 0.962 ± 0.012 | 0.963 ± 0.011 | 0.958 ± 0.013 | **0.967 ± 0.01** | 0.96 ± 0.013 | 0.965 ± 0.008 | 0.963 ± 0.013 |
| | em_smote | 0.948 ± 0.022 | 0.956 ± 0.015 | **0.964 ± 0.013** | 0.962 ± 0.009 | **0.965 ± 0.01** | 0.962 ± 0.012 | **0.967 ± 0.012** | 0.964 ± 0.009 | 0.963 ± 0.014 |
| | GSM_base | 0.934 ± 0.三个 | 0.958 ± 0.008 | **0.964 ± 0.017** | **0.966 ± 0.011** | 0.962 ± 0.011 | **0.968 ± 0.009** | **0.966 ± 0.011** | **0.966 ± 0.012** | **0.968 ± 0.012** |
| | GSM_S | 0.938 ± 0.019 | **0.96 ± 0.012** | 0.962 ± 0.012 | 0.963 ± 0.009 | **0.966 ± 0.012** | 0.964 ± 0.012 | 0.961 ± 0.009 | 0.962 ± 0.014 | **0.967 ± 0.012** |
| | GSM_PT | 0.946 ± 0.015 | **0.96 ± 0.011** | 0.962 ± 0.01 | 0.96 ± 0.013 | 0.963 ± 0.012 | 0.966 ± 0.012 | 0.963 ± 0.009 | **0.967 ± 0.011** | 0.966 ± 0.012 |
| | **HetGSM** | **0.951 ± 0.012** | **0.961 ± 0.01** | **0.965 ± 0.013** | **0.966 ± 0.013** | **0.964 ± 0.012** | **0.964 ± 0.012** | **0.967 ± 0.014** | **0.962 ± 0.015** | **0.967 ± 0.013** |
| Pubmed | no | 0.131 ± 0.011 | 0.138 ± 0.011 | 0.158 ± 0.016 | 0.152 ± 0.014 | 0.168 ± 0.02 | 0.141 ± 0.012 | 0.149 ± 0.013 | 0.153 ± 0.011 | 0.154 ± 0.018 |
| | up | 0.147 ± 0.016 | 0.147 ± 0.015 | **0.167 ± 0.014** | 0.15 ± 0.015 | **0.168 ± 0.015** | 0.146 ± 0.019 | 0.151 ± 0.023 | 0.154 ± 0.013 | 0.154 ± 0.023 |
| | smote | 0.159 ± 0.022 | 0.159 ± 0.022 | 0.149 ± 0.017 | 0.149 ± 0.024 | 0.163 ± 0.013 | 0.156 ± 0.021 | 0.151 ± 0.018 | 0.148 ± 0.024 | 0.159 ± 0.019 |
| | reweight | 0.168 ± 0.019 | 0.168 ± 0.019 | 0.153 ± 0.013 | 0.154 ± 0.015 | 0.158 ± 0.02 | 0.158 ± 0.017 | **0.164 ± 0.016** | 0.156 ± 0.016 | 0.153 ± 0.009 |
| | embed_sm | 0.14 ± 0.015 | 0.149 ± 0.015 | 0.164 ± 0.011 | 0.151 ± 0.012 | 0.158 ± 0.006 | 0.153 ± 0.012 | 0.154 ± 0.015 | 0.153 ± 0.016 | 0.159 ± 0.019 |
| | em_smote | 0.154 ± 0.021 | 0.154 ± 0.021 | 0.157 ± 0.016 | 0.153 ± 0.013 | 0.154 ± 0.013 | **0.16 ± 0.012** | 0.156 ± 0.017 | 0.146 ± 0.015 | 0.154 ± 0.018 |
| | GSM_base | 0.151 ± 0.013 | 0.151 ± 0.013 | 0.165 ± 0.018 | 0.147 ± 0.024 | 0.159 ± 0.016 | 0.151 ± 0.012 | 0.145 ± 0.018 | **0.157 ± 0.015** | 0.154 ± 0.013 |
| | GSM_S | 0.148 ± 0.01 | 0.148 ± 0.011 | 0.156 ± 0.018 | 0.15 ± 0.02 | 0.158 ± 0.014 | 0.15 ± 0.02 | 0.15 ± 0.014 | 0.149 ± 0.16 | 0.155 ± 0.04 |
| | GSM_PT | 0.164 ± 0.025 | 0.164 ± 0.025 | **0.169 ± 0.013** | 0.154 ± 0.018 | 0.164 ± 0.02 | 0.154 ± 0.021 | 0.151 ± 0.012 | **0.159 ± 0.019** | 0.156 ± 0.012 |
| | **HetGSM** | **0.17 ± 0.018** | **0.171 ± 0.017** | **0.169 ± 0.016** | **0.151 ± 0.012** | **0.163 ± 0.019** | **0.15 ± 0.016** | **0.158 ± 0.017** | **0.156 ± 0.017** | **0.157 ± 0.013** |
| DBLP | no | 0.624 ± 0.05 | 0.669 ± 0.048 | 0.728 ± 0.056 | 0.746 ± 0.041 | 0.785 ± 0.028 | **0.799 ± 0.061** | 0.765 ± 0.046 | 0.751 ± 0.034 | 0.769 ± 0.047 |
| | up | 0.664 ± 0.03 | 0.706 ± 0.037 | 0.719 ± 0.041 | 0.751 ± 0.042 | 0.78 ± 0.047 | 0.775 ± 0.046 | **0.79 ± 0.043** | **0.796 ± 0.031** | **0.826 ± 0.038** |
| | smote | 0.639 ± 0.034 | 0.677 ± 0.045 | 0.715 ± 0.052 | 0.754 ± 0.043 | 0.769 ± 0.04 | 0.762 ± 0.04 | **0.791 ± 0.033** | 0.771 ± 0.036 | 0.762 ± 0.044 |
| | reweight | 0.646 ± 0.021 | 0.69 ± 0.044 | 0.735 ± 0.049 | **0.77 ± 0.055** | **0.8 ± 0.036** | **0.805 ± 0.018** | 0.776 ± 0.046 | **0.791 ± 0.048** | 0.777 ± 0.046 |
| | embed_sm | 0.637 ± 0.024 | 0.683 ± 0.04 | 0.705 ± 0.039 | 0.738 ± 0.043 | 0.767 ± 0.023 | 0.769 ± 0.03 | 0.768 ± 0.033 | 0.774 ± 0.03 | 0.781 ± 0.036 |
| | em_smote | 0.645 ± 0.039 | 0.684 ± 0.049 | 0.715 ± 0.048 | 0.746 ± 0.044 | 0.764 ± 0.04 | 0.775 ± 0.022 | 0.736 ± 0.051 | 0.762 ± 0.034 | 0.751 ± 0.059 |
| | GSM_base | 0.639 ± 0.06 | 0.668 ± 0.039 | **0.752 ± 0.036** | 0.758 ± 0.035 | 0.777 ± 0.047 | 0.791 ± 0.027 | 0.786 ± 0.053 | 0.788 ± 0.034 | **0.8 ± 0.028** |
| | GSM_S | 0.629 ± 0.053 | 0.657 ± 0.037 | 0.715 ± 0.048 | 0.756 ± 0.043 | 0.759 ± 0.045 | **0.808 ± 0.029** | **0.796 ± 0.029** | **0.792 ± 0.022** | **0.79 ± 0.031** |
| | GSM_PT | 0.635 ± 0.04 | 0.693 ± 0.054 | 0.733 ± 0.058 | 0.726 ± 0.039 | 0.769 ± 0.02 | 0.777 ± 0.04 | **0.795 ± 0.028** | **0.802 ± 0.021** | **0.8 ± 0.029** |
| | **HetGSM** | **0.665 ± 0.032** | **0.714 ± 0.055** | **0.744 ± 0.043** | **0.762 ± 0.048** | **0.761 ± 0.04** | **0.767 ± 0.03** | **0.764 ± 0.045** | **0.784 ± 0.031** | **0.787 ± 0.044** |


### Training Size Comparison
Evaluates the HAN model on IMDB with training sizes (50, 80, 100, 150) across various settings (no, up, smote, reweight, embed_sm, em_smote, GSM_base, GSM_S, GSM_PT, HetGSM). 

| Settings | 50 | 80 | 100 | 150 |
|----------|----|----|-----|-----|
| no | 0.769 ± 0.047 | 0.809 ± 0.033 | 0.807 ± 0.04 | 0.821 ± 0.028 |
| up | 0.758 ± 0.041 | 0.812 ± 0.025 | 0.809 ± 0.04 | 0.835 ± 0.022 |
| smote | 0.758 ± 0.031 | 0.792 ± 0.037 | 0.799 ± 0.032 | 0.83 ± 0.014 |
| reweight | 0.791 ± 0.045 | **0.818 ± 0.026** | **0.822 ± 0.021** | 0.842 ± 0.016 |
| embed_sm | 0.734 ± 0.06 | 0.808 ± 0.028 | 0.799 ± 0.026 | 0.824 ± 0.033 |
| em_smote | 0.772 ± 0.052 | 0.807 ± 0.029 | 0.81 ± 0.031 | 0.823 ± 0.023 |
| GSM_base | 0.732 ± 0.06 | 0.751 ± 0.034 | 0.779 ± 0.039 | 0.797 ± 0.034 |
| GSM_S | 0.786 ± 0.035 | 0.787 ± 0.053 | 0.825 ± 0.027 | 0.842 ± 0.012 |
| GSM_PT | 0.775 ± 0.051 | 0.813 ± 0.031 | 0.817 ± 0.027 | _0.833 ± 0.013_ |
| **HetGSM** | **0.753 ± 0.033** | **0.808 ± 0.034** | **0.813 ± 0.024** | **0.846 ± 0.012** |

### Upsampling Ratio Comparison
Analyzes the HGNN model with upsampling ratios (0.2 to 1.2) on the IMDb dataset. **HetGSM** at a ratio of 1.2 achieves the highest accuracy (0.515 ± 0.022), highlighting the effectiveness of balanced upsampling. **GSM_PT** also performs strongly, particularly at a ratio of 1.0 (0.51 ± 0.022).

| Setting | 0.2 | 0.4 | 0.6 | 0.8 | 1.0 | 1.2 |
|---------|-----|-----|-----|-----|-----|-----|
| no | 0.505 ± 0.027 | 0.496 ± 0.023 | 0.505 ± 0.025 | 0.501 ± 0.021 | 0.505 ± 0.027 | 0.509 ± 0.021 |
| up | 0.5 ± 0.029 | 0.501 ± 0.026 | 0.505 ± 0.024 | 0.504 ± 0.027 | 0.499 ± 0.021 | 0.509 ± 0.024 |
| smote | **0.507 ± 0.019** | 0.5 ± 0.015 | 0.504 ± 0.018 | 0.498 ± 0.019 | 0.502 ± 0.02 | 0.505 ± 0.023 |
| reweight | 0.5 ± 0.019 | 0.501 ± 0.013 | 0.504 ± 0.022 | 0.503 ± 0.019 | 0.5 ± 0.026 | 0.5 ± 0.018 |
| embed_sm | 0.503 ± 0.02 | 0.5 ± 0.02 | 0.496 ± 0.02 | **0.506 ± 0.019** | 0.502 ± 0.018 | 0.496 ± 0.018 |
| em_smote | 0.495 ± 0.021 | **0.508 ± 0.025** | 0.498 ± 0.026 | 0.502 ± 0.02 | 0.503 ± 0.027 | 0.494 ± 0.021 |
| GSM_base | 0.5 ± 0.023 | 0.502 ± 0.016 | 0.493 ± 0.018 | 0.494 ± 0.023 | 0.501 ± 0.027 | 0.492 ± 0.012 |
| GSM_S | 0.501 ± 0.023 | 0.492 ± 0.018 | 0.501 ± 0.011 | 0.501 ± 0.021 | 0.495 ± 0.019 | 0.49 ± 0.024 |
| GSM_PT | 0.502 ± 0.02 | 0.506 ± 0.015 | 0.506 ± 0.024 | 0.503 ± 0.016 | _0.51 ± 0.022_ | 0.506 ± 0.022 |
| **HetGSM** | **0.504 ± 0.019** | **0.507 ± 0.02** | **0.506 ± 0.018** | **0.508 ± 0.019** | **0.509 ± 0.021** | **0.515 ± 0.022** |



## 📄 Citation

> This repository is part of an anonymous submission. Please do not cite until the paper is published.

---

## 🔐 Anonymity Notice

This repository has been anonymized for peer review. No identifying information is stored in commit metadata or filenames. If any such information is discovered, please report it.

---

 <!-- args.py: Defines hyperparameters and other parameters

raw_Data_process: Reads and processes raw data into files

DeepWalk.py: Uses het_random_walks, which is a list of random walks, in Word2Vec model to generate learned feature embeddings 
            for nodes of all types. Output: node_net_embedding.txt

data_generator.py: (a: author, p: paper, v: venue)

  A)                  Data File                            |         Matrix                                                           
    1) a_p_list_train.txt- a:{List of written papers}        ---- a_p_list_train 
    2) p_a_list_train.txt- p:{List of authors} (Same as 1)   ---- p_a_list_train
    3) p_p_citation_list.txt- p:{List of cited papers}       ---- p_p_cite_list_train
    4) v_p_list_train.txt- v:{List of papers}                ---- v_p_list_train 
    5) p_v.txt- p:v                                          ---- p_v

    # Read these to corresponding numpy matrices: a_p_list_train, p_a_list_train, p_p_cite_list_train, v_p_list_train, and
    # p_neigh_list_train: [[p, {List of author neighbours}, {List of cited papers}, {List of venue neighbour}] ...]

  B)                  Data File                           |         Matrix 
    1) p_abstract_embed.txt- p {embedding of dim 128}       ---- p_abstract_embed  
    2) p_title_embed.txt- p {embedding of dim 128}          ---- p_title_embed
    3) node_net_embedding- {a/p/v} {embedding of dim 128}   ---- a_net_embed, p_net_embed, v_net_embed
 
  C) p_v_net_embed: [p v_net_embed[v]], each row index corresponding to p, the row is filled with net_embed of corresponding v. 

  D) p_a_net_embed: [p mean(a_net_embed[{List of author neighbours}])]: Vanilla aggregated neighbour author embedding to p

  E) p_ref_net_embed: [p mean(p_net_embed[{List of cited papers}])]: : vanilla aggregated neighbour paper embedding to p

  F) a_text_embed: Shape[a, 3*embed_dim/(3*128)] Stores the abstract info of top 3 neighbour papers
    1) if len(written papers) > 3: [[a {p_abstract_embed[Neighbour 1]}, {p_abstract_embed[Neighbour 2]}, {For 3}] ...]
    2) if len(written papers) < 3 (not empty): Concat one embedding twice or thrice

  G) v_text_embed: [[v {p_abstract_embed[Neighbour 1]}, {p_abstract_embed[Neighbour 2]}, {Upto 5}] ...] Use p_v

  H) Use het_neigh_train.txt- a/p/v {Neighbours from random walk}
    1) a_neigh_list_train: [[a {List of author neighbours}][a {List of papers}][a {List of venue neighbours}]] 
	2) p_neigh_list_train: " (Similar to above)
    3) v_neigh_list_train: "
    4) a_neigh_list_train_top, p_neigh_list_train_top, v_neigh_list_train_top: Only neighbours above threshold are taken: [a=10,p=10,v=3]
 
  I) train_id_list = [[] for i in range(3)] Stores ids at each row a/pv. Uses a_neigh_list_train, p_neigh_list_train, v_neigh_list_train

--------------------> 